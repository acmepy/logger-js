var e=require("fs"),i=require("dayjs");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/t(e),s=/*#__PURE__*/t(i);function o(e){var i=function(e){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var t=i.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof i?i:i+""}var l={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,OFF:99},n=new(/*#__PURE__*/function(){function e(){this.break=[],this.level=0,this.console={},this.file=!1,this.name=!1,this.hideSecrets=!1}var i,t,n=e.prototype;return n.config=function(e){var i=e.name,t=void 0===i?"my logger":i,r=e.displayConsole,s=void 0!==r&&r,o=e.level,n=void 0===o?l.TRACE:o,a=e.hideSecrets,c=void 0===a||a;this.file=e.file,this.name=t,this.console={display:s,log:console.log,error:console.error},this.level=n,this.hideSecrets=c},n.addBreak=function(e){this.break.push(e),this.info("lib/logger","addBreak",this.break)},n.setName=function(e){this.name=e},n.trace=function(){var e=[].slice.call(arguments);e.unshift("TRACE"),this.log(e)},n.debug=function(){var e=[].slice.call(arguments);e.unshift("DEBUG"),this.log(e)},n.info=function(){var e=[].slice.call(arguments);e.unshift("INFO"),this.log(e)},n.warn=function(){var e=[].slice.call(arguments);e.unshift("WARN"),this.log(e)},n.error=function(){var e=[].slice.call(arguments);e.unshift("ERROR"),this.log(e)},n.log=function(e){var i=(e=this.filterLogger(e)).shift(),t=e.shift();if(0==this.break.length&&this.level<=l[i]||this.break.includes(t)||["ERROR","FATAL"].includes(i)){var r,o=this.name.indexOf("]")>-1?this.name:"["+this.name+"]",n=["["+s.default().format("HH:mm:ss")+"]","["+i+"]",o,"["+t+"]"].concat(e);if(this.console.display||["ERROR","FATAL"].includes(i))if(["ERROR","FATAL"].includes(i))(r=this.console).error.apply(r,n);else if(["WARN"].includes(i)){var a;(a=this.console).warn.apply(a,n)}else{var c;(c=this.console).log.apply(c,n)}this.file&&(n.shift(),n=["["+s.default().format("HH:mm:ss")+"]"].concat(n),this.writeFile(this.file,n))}},n.writeFile=function(e,i){var t=e.split("/").slice(0,-1).join("/");r.default.existsSync(t)||r.default.mkdirSync(t,{recursive:!0}),r.default.appendFile(e,i+"\n",function(e){e&&console.error("logger writeFile",e)})},n.filterLogger=function(e){for(var i=0;i<e.length;i++){var t;"Logger"==(null==(t=e[i])||null==(t=t.constructor)?void 0:t.name)?e.splice(i,1):e[i].logger?delete e[i].logger:e[i].cert?e[i].cert=e[i].cert.substring(0,10)+"..."+e[i].cert.substring(e[i].cert.length-10):e[i].password?e[i].password=e[i].password.replace(e[i].password,"*"):e[i].pass&&!this.hideSecrets?e[i].pass=e[i].pass.replace(e[i].pass,"*"):e[i].clave&&!this.hideSecrets?e[i].clave=e[i].clave.replace(e[i].clave,"*"):e[i].token&&!this.hideSecrets?e[i].token=e[i].token.replace(e[i].token,"*"):e[i]instanceof Error?e[i]=e[i].message+"\nstack:"+e[i].stack:"object"==typeof e[i]?e[i]=JSON.stringify(e[i]):Array.isArray(e[i])&&(e[i]=e[i].join(","))}return e},i=e,(t=[{key:"levels",get:function(){return l}}])&&function(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}());exports.createLogger=function(e){var i=e.name,t=e.displayConsole,r=e.level;n.config({file:e.file,name:void 0===i?"my logger":i,displayConsole:void 0!==t&&t,level:void 0===r?l.TRACE:r})},exports.logger=n;
//# sourceMappingURL=logger.cjs.map
