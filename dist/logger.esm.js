import e from"fs";import i from"dayjs";function t(e){var i=function(e){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var t=i.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof i?i:i+""}var r={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,OFF:99};function s(e){var i=e.name,t=e.displayConsole,s=e.level;o.config({file:e.file,name:void 0===i?"my logger":i,displayConsole:void 0!==t&&t,level:void 0===s?r.TRACE:s})}var o=new(/*#__PURE__*/function(){function s(){this.break=[],this.level=0,this.console={},this.file=!1,this.name=!1,this.hideSecrets=!1}var o,n,l=s.prototype;return l.config=function(e){var i=e.name,t=void 0===i?"my logger":i,s=e.displayConsole,o=void 0!==s&&s,n=e.level,l=void 0===n?r.TRACE:n,a=e.hideSecrets,c=void 0===a||a;this.file=e.file,this.name=t,this.console={display:o,log:console.log,error:console.error},this.level=l,this.hideSecrets=c},l.addBreak=function(e){this.break.push(e),this.info("lib/logger","addBreak",this.break)},l.setName=function(e){this.name=e},l.trace=function(){var e=[].slice.call(arguments);e.unshift("TRACE"),this.log(e)},l.debug=function(){var e=[].slice.call(arguments);e.unshift("DEBUG"),this.log(e)},l.info=function(){var e=[].slice.call(arguments);e.unshift("INFO"),this.log(e)},l.warn=function(){var e=[].slice.call(arguments);e.unshift("WARN"),this.log(e)},l.error=function(){var e=[].slice.call(arguments);e.unshift("ERROR"),this.log(e)},l.log=function(e){var t=(e=this.filterLogger(e)).shift(),s=e.shift();if(0==this.break.length&&this.level<=r[t]||this.break.includes(s)||["ERROR","FATAL"].includes(t)){var o,n=this.name.indexOf("]")>-1?this.name:"["+this.name+"]",l=["["+i().format("HH:mm:ss")+"]","["+t+"]",n,"["+s+"]"].concat(e);if(this.console.display||["ERROR","FATAL"].includes(t))if(["ERROR","FATAL"].includes(t))(o=this.console).error.apply(o,l);else if(["WARN"].includes(t)){var a;(a=this.console).warn.apply(a,l)}else{var c;(c=this.console).log.apply(c,l)}this.file&&(l.shift(),l=["["+i().format("YYYY-MM-DD HH:mm:ss")+"]"].concat(l),this.writeFile(this.file,l))}},l.writeFile=function(i,t){var r=i.split("/").slice(0,-1).join("/");e.existsSync(r)||e.mkdirSync(r,{recursive:!0}),e.appendFile(i,t+"\n",function(e){e&&console.error("logger writeFile",e)})},l.filterLogger=function(e){for(var i=0;i<e.length;i++){var t;"Logger"==(null==(t=e[i])||null==(t=t.constructor)?void 0:t.name)?e.splice(i,1):e[i].logger?delete e[i].logger:e[i].cert?e[i].cert=e[i].cert.substring(0,10)+"..."+e[i].cert.substring(e[i].cert.length-10):e[i].password?e[i].password=e[i].password.replace(e[i].password,"*"):e[i].pass&&!this.hideSecrets?e[i].pass=e[i].pass.replace(e[i].pass,"*"):e[i].clave&&!this.hideSecrets?e[i].clave=e[i].clave.replace(e[i].clave,"*"):e[i].token&&!this.hideSecrets?e[i].token=e[i].token.replace(e[i].token,"*"):e[i]instanceof Error?e[i]=e[i].message+"\nstack:"+e[i].stack:"object"==typeof e[i]?e[i]=JSON.stringify(e[i]):Array.isArray(e[i])&&(e[i]=e[i].join(","))}return e},o=s,(n=[{key:"levels",get:function(){return r}}])&&function(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,t(s.key),s)}}(o,n),Object.defineProperty(o,"prototype",{writable:!1}),o}());export{s as createLogger,o as logger};
//# sourceMappingURL=logger.esm.js.map
